{"remainingRequest":"/var/www/html/MidTrade/Capstone/vue/milestone9_titus/node_modules/babel-loader/lib/index.js!/var/www/html/MidTrade/Capstone/vue/milestone9_titus/node_modules/cache-loader/dist/cjs.js??ref--0-0!/var/www/html/MidTrade/Capstone/vue/milestone9_titus/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/html/MidTrade/Capstone/vue/milestone9_titus/src/components/UploadListingImage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/var/www/html/MidTrade/Capstone/vue/milestone9_titus/src/components/UploadListingImage.vue","mtime":1615755992983},{"path":"/var/www/html/MidTrade/Capstone/vue/milestone9_titus/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/html/MidTrade/Capstone/vue/milestone9_titus/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/var/www/html/MidTrade/Capstone/vue/milestone9_titus/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/html/MidTrade/Capstone/vue/milestone9_titus/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdVcGxvYWRMaXN0aW5nSW1hZ2UnLAogIHByb3BzOiBbJ2xpc3RpbmcnXSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0YTogdGhpcy5saXN0aW5nLAogICAgICBmaWxlSW5wdXQ6ICcnLAogICAgICB2YWxpZFR5cGVzOiBbImltYWdlL2pwZyIsICJpbWFnZS9qcGVnIiwgImltYWdlL3BuZyJdCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgY2hlY2tBbmRTdWJtaXQ6IGZ1bmN0aW9uIGNoZWNrQW5kU3VibWl0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMudmFsaWRUeXBlcy5pbmNsdWRlcyh0aGlzLmZpbGVJbnB1dC50eXBlKSkgewogICAgICAgIGNvbnNvbGUubG9nKCJTdWNjZXNzZnVsIHVwbG9hZCIpOwogICAgICB9IGVsc2UgewogICAgICAgIGFsZXJ0KCdZb3UgYXR0ZW1wdGVkIHRvIHVwbG9hZCBhbiBpbWFnZSBmaWxlIHdpdGggYW4gaW52YWxpZCB0eXBlLiBDbGVhciB0aGUgZmllbGQgYW5kIHRyeSB1cGxvYWRpbmcgYSBQTkcsIEpQRywgb3IgSlBFRycpOwogICAgICB9IC8vIE5vdyBjaGVjayB0aGUgbnVtYmVyIG9mIGltYWdlcyByZWxhdGVkIHRvIHRoaXMgbGlzdGluZy4KCgogICAgICBheGlvcy5nZXQoImh0dHA6Ly9taWRuLmNzLnVzbmEuZWR1L01pZFRyYWRlL0NhcHN0b25lL3Z1ZS9taWxlc3RvbmU5X3RpdHVzL3NyYy9kYi9nZXRJbWFnZUNvdW50QnlMaXN0aW5nLnBocD9pZD0iICsgdGhpcy5saXN0aW5nLmxpc3RpbmdJRCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgdmFyIGltYWdlc0luREIgPSByZXN1bHQuZGF0YS5wYXlsb2FkWzBdLmNvdW50OwoKICAgICAgICBpZiAoaW1hZ2VzSW5EQiA9PSAzKSB7CiAgICAgICAgICBhbGVydCgnWW91IG1heSBub3QgaGF2ZSBtb3JlIHRoYW4gMyBpbWFnZXMgYXNzb2NpYXRlZCB3aXRoIHRoaXMgbGlzdGluZyBhdCBhIHRpbWUnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gSWYgSSBtYWRlIGl0IHRoaXMgZmFyLCB0aGVuIEknbSBnb29kIHRvIGluc2VydCBhIG5ldyBpbWFnZS4KICAgICAgICAgIHZhciBmZCA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgICAgZmQuYXBwZW5kKCdpbWFnZScsIF90aGlzLmZpbGVJbnB1dCwgX3RoaXMuZmlsZUlucHV0Lm5hbWUpOwogICAgICAgICAgZmQuYXBwZW5kKCdsaXN0aW5nSUQnLCBfdGhpcy5saXN0aW5nLmxpc3RpbmdJRCk7CiAgICAgICAgICBheGlvcy5wb3N0KCJodHRwOi8vbWlkbi5jcy51c25hLmVkdS9NaWRUcmFkZS9DYXBzdG9uZS92dWUvbWlsZXN0b25lOV90aXR1cy9zcmMvZGIvaGFuZGxlTGlzdGluZ0ltYWdlLnBocCIsIGZkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSAiQ291bGQgbm90IHVwbG9hZCBpbWFnZSIpIGFsZXJ0KHJlc3VsdCk7ZWxzZSBhbGVydCgiSW1hZ2Ugc3VjY2Vzc2Z1bGx5IHVwbG9hZGVkIik7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["UploadListingImage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA,OAAA,KAAA,MAAA,OAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,oBADA;AAEA,EAAA,KAAA,EAAA,CAAA,SAAA,CAFA;AAGA,EAAA,IAHA,kBAGA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,KAAA,OADA;AAEA,MAAA,SAAA,EAAA,EAFA;AAGA,MAAA,UAAA,EAAA,CAAA,WAAA,EAAA,YAAA,EAAA,WAAA;AAHA,KAAA;AAKA,GATA;AAUA,EAAA,OAAA,EAAA;AACA,IAAA,cAAA,EAAA,0BAAA;AAAA;;AACA,UAAA,KAAA,UAAA,CAAA,QAAA,CAAA,KAAA,SAAA,CAAA,IAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,mBAAA;AACA,OAFA,MAEA;AACA,QAAA,KAAA,CAAA,mHAAA,CAAA;AACA,OALA,CAOA;;;AACA,MAAA,KAAA,CAAA,GAAA,CAAA,yGAAA,KAAA,OAAA,CAAA,SAAA,EACA,IADA,CACA,UAAA,MAAA,EAAA;AACA,YAAA,UAAA,GAAA,MAAA,CAAA,IAAA,CAAA,OAAA,CAAA,CAAA,EAAA,KAAA;;AAEA,YAAA,UAAA,IAAA,CAAA,EAAA;AACA,UAAA,KAAA,CAAA,4EAAA,CAAA;AACA,SAFA,MAEA;AAEA;AACA,cAAA,EAAA,GAAA,IAAA,QAAA,EAAA;AACA,UAAA,EAAA,CAAA,MAAA,CAAA,OAAA,EAAA,KAAA,CAAA,SAAA,EAAA,KAAA,CAAA,SAAA,CAAA,IAAA;AACA,UAAA,EAAA,CAAA,MAAA,CAAA,WAAA,EAAA,KAAA,CAAA,OAAA,CAAA,SAAA;AACA,UAAA,KAAA,CAAA,IAAA,CAAA,8FAAA,EAAA,EAAA,EACA,IADA,CACA,UAAA,MAAA,EAAA;AACA,gBAAA,MAAA,IAAA,wBAAA,EACA,KAAA,CAAA,MAAA,CAAA,CADA,KAGA,KAAA,CAAA,6BAAA,CAAA;AACA,WANA,EAOA,KAPA,CAOA,UAAA,CAAA,EAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AACA,WATA;AAUA;AACA,OAvBA,EAwBA,KAxBA,CAwBA,UAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AACA,OA1BA;AA6BA;AAtCA;AAVA,CAAA","sourcesContent":["<template>\n  <v-dialog max-width=\"600px\">\n    <template v-slot:activator=\"{on, attrs}\">\n    <v-btn color=\"primary\" text v-bind=\"attrs\" v-on=\"on\">Upload Image</v-btn>\n    </template>\n    <v-card>\n      <v-card-title>\n        <h2>Upload Image For: {{this.listing.productName}}</h2> \n      </v-card-title>\n\n      <v-card-text>\n          <v-form>\n            <v-container>\n              <p>You can upload an image of the product you're selling here. You may only upload one image at a time</p> \n            \n              <v-row>\n                <v-col cols=\"12\">\n                  <v-form>\n                    <v-file-input\n                      v-model=\"fileInput\"\n                      label=\"Click Here to Browse Files\"\n                      counter\n                      :rules=\"['Required']\"\n                    ></v-file-input>\n                  </v-form>\n                </v-col>\n              </v-row>\n            </v-container>\n          </v-form>\n      </v-card-text>\n \n      <v-card-actions>\n        <v-btn\n          color=\"primary\"\n          @click=\"checkAndSubmit()\"  \n        >\n          Upload Image\n        </v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-dialog> \n</template>\n\n<script>\nimport axios from 'axios';\nexport default {\n  name: 'UploadListingImage',\n  props: ['listing'],\n  data() {\n    return {\n      data: this.listing,\n      fileInput: '',\n      validTypes: [\"image/jpg\", \"image/jpeg\", \"image/png\"]\n    }\n  },\n  methods: {\n    checkAndSubmit: function() {\n      if(this.validTypes.includes(this.fileInput.type)) {\n        console.log(\"Successful upload\")\n      } else {\n        alert('You attempted to upload an image file with an invalid type. Clear the field and try uploading a PNG, JPG, or JPEG')\n      }\n\n      // Now check the number of images related to this listing.\n      axios.get(\"http://midn.cs.usna.edu/MidTrade/Capstone/vue/milestone9_titus/src/db/getImageCountByListing.php?id=\" + this.listing.listingID)\n      .then(result => {\n         let imagesInDB = result.data.payload[0].count\n         \n         if(imagesInDB == 3) {\n           alert('You may not have more than 3 images associated with this listing at a time') \n         } else {\n\n           // If I made it this far, then I'm good to insert a new image.\n           const fd = new FormData();\n           fd.append('image', this.fileInput, this.fileInput.name)\n           fd.append('listingID', this.listing.listingID)\n           axios.post(\"http://midn.cs.usna.edu/MidTrade/Capstone/vue/milestone9_titus/src/db/handleListingImage.php\", fd)\n           .then(result => {\n             if(result == \"Could not upload image\")\n                alert(result)\n             else\n                alert(\"Image successfully uploaded\")\n             })\n           .catch(e => {\n             console.log(e)\n            })\n         }\n      })\n      .catch(e => {\n        console.log(e)\n      }) \n\n     \n    } \n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n"],"sourceRoot":"src/components"}]}